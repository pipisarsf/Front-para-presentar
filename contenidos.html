<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="assets/images/logo.png" type="image/png">
    <title>Instituto el Sabio</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="assets/images/logo.png" alt="logo instituto">
            <h2 class="nombre_empresa">Instituto el Sabio</h2>
        </div>

        <nav class="valores">
            <div>
                <button class="boton">Excelencia Académica</button>
                <div class="descripcion">Nos comprometemos con la Excelencia Académica, promoviendo un entorno donde el aprendizaje y la innovación son fundamentales. Nuestro objetivo es proporcionar una educación de calidad que desafíe a nuestros estudiantes a alcanzar su máximo potencial, fomentando el pensamiento crítico, la creatividad y el amor por el conocimiento.</div>
            </div>
            <div>
                <button class="boton">Integridad</button>
                <div class="descripcion">La Integridad es un valor central. Nos esforzamos por inculcar principios éticos y morales sólidos en nuestros estudiantes, promoviendo la honestidad, la transparencia y el respeto por la verdad. Creemos que una educación basada en la integridad prepara a nuestros estudiantes para ser ciudadanos responsables y líderes confiables en la sociedad.</div>
            </div>
            <div>
                <button class="boton">Respeto</button>
                <div class="descripcion">El Respeto es la base de todas nuestras interacciones. Valoramos la diversidad y la individualidad, y fomentamos un ambiente donde cada persona es tratada con dignidad y consideración. Nuestro enfoque en el respeto ayuda a crear una comunidad escolar inclusiva y armoniosa, donde todos pueden aprender y crecer juntos.</div>
            </div>
            <div>
                <button class="boton">Inclusión</button>
                <div class="descripcion">Estamos dedicados a la Inclusión, asegurando que todos los estudiantes, independientemente de sus antecedentes, habilidades o circunstancias, tengan acceso a una educación equitativa y de alta calidad. Promovemos la igualdad de oportunidades y trabajamos para eliminar barreras, creando un entorno donde cada estudiante se sienta valorado y apoyado.</div>
            </div>
            <div>
                <button class="boton">Innovación</button>
                <div class="descripcion">La Innovación es una piedra angular. Fomentamos un espíritu de curiosidad y creatividad, alentando a nuestros estudiantes y docentes a explorar nuevas ideas y enfoques en el proceso educativo. A través de la innovación, buscamos preparar a nuestros estudiantes para enfrentar los desafíos del futuro con confianza y habilidades avanzadas.</div>
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="form-container">
            <img src="assets/images/logo.png" alt="logo institucional">
            <p class="text">Carga de Contenidos</p>

            <form id="contenidoForm" class="opciones-form" action="guardar_contenido.php" method="POST" enctype="multipart/form-data">
                <label for="materia">Asignatura:</label>
                <select name="materia" id="materia" required>
                    <option value="">Seleccione una asignatura</option>
                </select>
                <br>
            
                <label for="contenido">Contenido:</label>
                <select name="contenido_id" id="contenido" required>
                    <option value="">Seleccione un contenido</option>
                </select>
                <br>
            
                <label for="alumno">Estudiante:</label>
                <select name="estudiante_id" id="alumno" required>
                    <option value="">Seleccione el estudiante</option>
                </select>
                <br>
            
                <label for="estadoContenido">Nivel de Desempeño:</label>
                <select name="nivel_desempeno" id="estadoContenido" required>
                    <option value="">Seleccione un nivel de desempeño</option>
                    <option value="Altamente Logrado">Altamente Logrado</option>
                    <option value="Logrado">Logrado</option>
                    <option value="Escasamente Logrado">Escasamente Logrado</option>
                    <option value="Pendiente">Pendiente</option>
                </select>
                <br>
            
                <button type="submit">Guardar</button>
                <button type="button" onclick="location.href='ver_registros.php';">Ver Registros</button>
            </form>
                       
        </div>
    </div>

    <div id="resultadoModal" class="modal">
        <div class="modal-content" style="position: relative;">
            <span class="close">&times;</span>
            <p id="resultadoMensaje"></p>
            <button class="volver">Volver</button>
        </div>
    </div>

    <footer>
        <div class="contacto">
            <a href="https://www.instagram.com/bajo_llave_cba">
                <img src="assets/images/ig.png" alt="Instagram" class="instagram-logo">
            </a>
            <a href="https://wa.me/message/BEAP2YX2KLMEC1">
                <img src="assets/images/wp.png" alt="Instagram" class="instagram-logo">
            </a>
          
            <p class="ubicacion">Ubicación: Calle Sin Nombre 123, B° Centro, Córdoba, Argentina</p>
        </div>
    </footer>
    

    <script>
        function llenarOpciones(lista, datos) {
            const select = document.getElementById(lista);
            select.innerHTML = '<option value="">Seleccione una opción</option>';
            if (datos && datos.length > 0) {
                datos.forEach(dato => {
                    const option = document.createElement("option");
                    option.text = dato.nombre_asignatura || dato.nombre_contenido || dato.nombre;
                    option.value = dato.id;
                    select.add(option);
                });
            } else {
                const option = document.createElement("option");
                option.text = "No hay opciones disponibles";
                select.add(option);
            }
        }

        window.onload = function() {
            fetch('obtener_datos.php')
            .then(response => {
                if (!response.ok) {
                    throw new Error("Error en la respuesta de la red");
                }
                return response.json();
            })
            .then(data => {
                if (data.success === false) {
                    console.error('Error en los datos recibidos:', data.message);
                    return;
                }

                llenarOpciones("materia", data.asignaturas);
                llenarOpciones("alumno", data.estudiantes);

                window.contenidos = data.contenidos;

                document.getElementById("materia").addEventListener("change", function() {
                    const materiaId = this.value;
                    const contenidosFiltrados = window.contenidos.filter(contenido => contenido.materia_id == materiaId);
                    llenarOpciones("contenido", contenidosFiltrados);
                });
            })
            .catch(error => console.error('Error al obtener los datos:', error));

            document.getElementById('contenidoForm').addEventListener('submit', function(event) {
                event.preventDefault();

                const formData = new FormData(this);

                fetch('guardar_contenido.php', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    const modal = document.getElementById('resultadoModal');
                    const mensaje = document.getElementById('resultadoMensaje');
                    mensaje.textContent = data.message;
                    modal.style.display = 'block';

                    if (data.success) {
                        document.getElementById('contenidoForm').reset();
                    }
                })
                .catch(error => console.error('Error al guardar el contenido:', error));
            });

            const closeModal = document.querySelector('.close');
            const volverButton = document.querySelector('.volver');

            if (closeModal && volverButton) {
                closeModal.onclick = function() {
                    document.getElementById('resultadoModal').style.display = 'none';
                };

                volverButton.onclick = function() {
                    document.getElementById('resultadoModal').style.display = 'none';
                    document.getElementById('contenidoForm').scrollIntoView({behavior: 'smooth'});
                };

                window.onclick = function(event) {
                    const modal = document.getElementById('resultadoModal');
                    if (event.target == modal) {
                        modal.style.display = 'none';
                    }
                };
            } else {
                console.error('No se encontró el elemento del modal.');
            }
        };
    </script>
</body>
</html>
